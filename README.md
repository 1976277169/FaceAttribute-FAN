# FaceAttribute-FAN

This respository includes a Caffe implementation of [FAN](https://www.ijcai.org/proceedings/2018/102) that achieves state-of-the-art performance on [CelebA](http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html) and LFWA face attribute benchmark.


### Citation

If this code is helpful for your research, please cite the following paper:

    @article{he2018harnessing,
      title={Harnessing Synthesized Abstraction Images to Improve Facial Attribute Recognition.},
      author={Keke He, Yanwei Fu, Wuhao Zhang, Chengjie Wang, Yu-Gang Jiang, Feiyue Huang, Xiangyang Xue},
      journal={Proceedings of the Twenty-Seventh International Joint Conference on
               Artificial Intelligence, {IJCAI-18}},
      pages={733-740}
      year={2018}
    }

## Introduction
![](data/demo/overview.png)

Our method leverages facial parts locations for better attribute prediction. A
facial abstraction is generated by a
Generative Adversarial Network (GAN). Then a dual-path facial attribute network is built which accepts inputs from original images and absraction images.

## Prerequisites
- Caffe
- Linux
- NVIDIA GPU + CUDA CuDNN 

## Getting Started

### Setup

Clone the github repository:

```bash
git  clone https://github.com/TencentYoutuResearch/FaceAttribute-FAN
cd FaceAttribute-FAN
```

### Model

Please download the trained models from [Google drive](https://drive.google.com/open?id=1DFd2pvLUEYo2CawaYH_CWVqsAiFtihcz), and put it into outputs folder.


### Demo
To test the dual-path model, 

```bash
sh demo_dual_path.sh
``` 
If you want to test your own image without synthesized abstraction image, you can

```bash
sh demo_single_path.sh
``` 

### Dataset
1. To train and evaluation the model on the CelebA benchmark, 
please download the CelebA dataset from [CelebA](http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html). 
2. Please download pretrained model and synthesized abstraction images of CelebA dataset from [Google drive](https://drive.google.com/open?id=1DFd2pvLUEYo2CawaYH_CWVqsAiFtihcz).
3. Put the original CelebA and synthesized abstraction image under the data/CelebA folder, for example:
	
	```	├── CelebA	│   ├── img_align_celeba	│   ├── img_celeba_pix2pix

	``` 

### Evaluation
```bash
cd evaluation
sh test_dual_path_celeba.sh
```

### Training 
```bash
cd models/dual_path_parse_resnet
sh train.sh
```